var child_process = require('child_process'),
    es = require("event-stream"),
    spawn = child_process.spawn,
    child,
    hasReported = false;

exports.returnStream = function() {
    if (!child) {
        child = spawn(__dirname+'/lmutracker');
    }

    return child.stdout.pipe(es.mapSync(function(data) {
        var splitData = data.toString().trim().split(' ');
        var value = splitData[splitData.length - 1];

        if (value == 0 && !hasReported) {
            hasReported = true;
            return null;
        }
        console.log(value);
        return value;
    }));
}

exports.stopStream = function() {
    if (child) {
        child.kill('SIGHUP');

    }
}